{% extends "base/base.html" %}
{% load static %}
{% block title %}Contact Us{% endblock %}

{% block content %}
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<!------ Include the above in your HEAD tag ---------->

<link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700,800&display=swap" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css">

<div class="pd-wrap">
    <div class="container">
        <!-- Back Button -->
        <a href="javascript:history.back()" class="back-btn">Back</a>

        <!-- Product Details Section -->
        <div class="heading-section">
            <h2>{{ cake.name }}</h2>
        </div>
        <div class="row">
            <div class="col-md-6">
                <!-- Single Image Display -->
                <div class="product-image">
                    <img src="{{ cake_images.first.image.url }}" alt="{{ cake.name }} Image" class="img-fluid">
                </div>
            </div>
            <div class="col-md-6">
                <div class="product-dtl">
                    <div class="product-info">
                        <div class="product-name">{{ cake.name }}</div>
                        <!-- <div class="reviews-counter">
                            <div class="rate">
                                <input type="radio" id="star5" name="rate" value="5" checked />
                                <label for="star5" title="text">5 stars</label>
                                <input type="radio" id="star4" name="rate" value="4" />
                                <label for="star4" title="text">4 stars</label>
                                <input type="radio" id="star3" name="rate" value="3" />
                                <label for="star3" title="text">3 stars</label>
                                <input type="radio" id="star2" name="rate" value="2" />
                                <label for="star2" title="text">2 stars</label>
                                <input type="radio" id="star1" name="rate" value="1" />
                                <label for="star1" title="text">1 star</label>
                            </div>
                            <span>{{ cake_reviews|length }} Reviews</span>
                        </div> -->
                        <div class="product-price-discount">
                            <span>${{ cake.price }}</span>
                            {% if cake.discount_price %}
                                <span class="line-through">${{ cake.discount_price }}</span>
                            {% endif %}
                        </div>
                    </div>
                    <p>{{ cake.description }}</p>
                    <div class="product-count d-flex align-items-center mt-3">
                        <form action="{% url 'add_to_cart' item_type='cake' item_id=cake.id %}" method="post">
                            {% csrf_token %}
                            <div class="product-count d-flex align-items-center mt-3">
                                <div class="form-group">
                                    <label for="size">Choose a size:</label>
                                    <select name="size_id" id="size" class="form-control">
                                        {% for size in cake.sizes.all %}
                                            <option value="{{ size.id }}">{{ size.size }} ( +{{ size.additional_price }}$ )</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="quantity">Quantity:</label>
                                    <input type="number" name="quantity" id="quantity" value="1" min="1" class="form-control">
                                </div>
                                <button type="submit" class="round-black-btn">Add to Cart</button>
                            </div>
                        </form>
                    </div>
                    
                </div>
            </div>
        </div>
        <div class="product-info-tabs">
            <ul class="nav nav-tabs" id="myTab" role="tablist">
                <li class="nav-item">
                    <a class="nav-link active" style="color: #430404;" id="description-tab" data-toggle="tab" href="#description" role="tab" aria-controls="description" aria-selected="true">Description</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" style="color: #430404;" id="review-tab" data-toggle="tab" href="#review" role="tab" aria-controls="review" aria-selected="false">Reviews ({{ cake_reviews|length }})</a>
                </li>
            </ul>
            <div class="tab-content" id="myTabContent">
                <div class="tab-pane fade show active" id="description" role="tabpanel" aria-labelledby="description-tab">
                    <h2>Description</h2>
                    <p>{{ cake.description }}</p>
                </div>
                <div class="tab-pane fade" id="review" role="tabpanel" aria-labelledby="review-tab">
                    <div class="review-heading">
                        <h2>REVIEWS</h2>
                    </div>
                    {% if cake_reviews %}
                        <p class="mb-20">There are {{ cake_reviews|length }} review{{ cake_reviews|length|pluralize }}.</p>
                        <div class="reviews">
                            {% for review in cake_reviews %}
                                <div class="review mb-3 p-3 border rounded">
                                    <div class="review-header d-flex justify-content-between align-items-center mb-2">
                                        <strong>{{ review.user }}</strong>
                                        <div class="stars">
                                            {% for i in number_range %}
                                                {% if review.rating >= i %}
                                                    <i class="fas fa-star"></i>
                                                {% else %}
                                                    <i class="far fa-star"></i>
                                                {% endif %}
                                            {% endfor %}
                                        </div>
                                    </div>
                                    <p>{{ review.comment }}</p>
                                    <p><small class="text-muted">{{ review.created_at }}</small></p>
                                </div>
                            {% empty %}
                                <p>No reviews yet.</p>
                            {% endfor %}
                        </div>
                    {% else %}
                        <p class="mb-20">There are no reviews yet.</p>
                    {% endif %}
                    <h3 class="mt-4">Submit Your Review</h3>
                    <form action="{% url 'cake_detail' cake_name=cake.name %}" method="post" class="review-form p-4 border rounded">
                        {% csrf_token %}
                        {{ form_reviews.as_p }}
                        <button type="submit" class="btn btn-primary">Submit Review</button>
                    </form>
                </div>
            </div>
            
            
        </div>
    </div>
</div>



<style>
    /* Star rating */
.rating {
    display: flex;
    gap: 5px;
    margin-bottom: 10px;
}

.rating input[type="radio"] {
    display: none;
}

.rating label {
    cursor: pointer;
    font-size: 24px;
    color: #ddd;
}

.rating input[type="radio"]:checked ~ label {
    color: gold;
}

.review-heading h2 {
    font-size: 24px;
    margin-bottom: 20px;
}

.reviews {
    margin-top: 20px;
}

.review {
    border: 1px solid #ddd;
    padding: 15px;
    border-radius: 5px;
    background-color: #f9f9f9;
}

.review-header {
    border-bottom: 1px solid #ddd;
    padding-bottom: 10px;
}

.review-header .stars {
    color: gold;
}

.review-header .fa-star {
    font-size: 18px;
}

.btn-primary {
    background-color: #ff69b4;
    border-color: #ff69b4;
}

.btn-primary:hover {
    background-color: #ff1493;
    border-color: #ff1493;
}

.rating .fa-star {
    color: #FFD700; /* Gold color for the stars */
    font-size: 20px; /* Adjust size of stars */
    margin-right: 2px; /* Space between stars */
}

.pd-wrap {
    padding: 40px 0;
    font-family: 'Poppins', sans-serif;
}

.back-btn {
    color: #430404;
    text-transform: none;
    margin-top: 20px;
    display: inline-block;
    text-align: center;
    padding: 10px 20px;
}

.back-btn:hover {
    background: #ddd;
    color: #FAABBD;
}

.heading-section {
    text-align: center;
    margin-bottom: 20px;
    color: #FAABBD;
}

.heading-section h2 {
    font-size: 32px;
    font-weight: 500;
    padding-top: 10px;
    padding-bottom: 15px;
    font-family: 'Poppins', sans-serif;
}

.product-image img {
    width: 100%;
    height: auto;
}

.product-dtl {
    padding: 15px;
}


.product-name {
    font-size: 22px;
    font-weight: 500;
    line-height: 22px;
    margin-bottom: 4px;
}

.product-price-discount {
    font-size: 22px;
    font-weight: 400;
    margin-bottom: 20px;
}

.product-price-discount span {
    color: #FAABBD;
}

.product-price-discount .line-through {
    text-decoration: line-through;
    color: #8c8c8c;
}

.product-options {
    display: flex;
    align-items: center; /* Ensure alignment for dropdown */
    margin-bottom: 20px;
}

.form-group {
    margin: 0;
}

.product-count {
    display: flex;
    align-items: center;
    justify-content: flex-start; /* Align items to the left */
    flex-wrap: wrap; /* Allow items to wrap to the next line on smaller screens */
}

.product-count form {
    display: flex;
    align-items: center;
}

.product-count .qtyminus, .product-count .qtyplus {
    display: inline-block;
    width: 30px;
    text-align: center;
    cursor: pointer;
}

.product-count .qty {
    width: 50px;
    text-align: center;
    border: 1px solid #ddd;
    border-radius: 5px;
    margin: 0 10px;
}


.qtyminus, .qtyplus {
    display: inline-block;
    width: 30px;
    text-align: center;
    cursor: pointer;
}

.qty {
    width: 50px;
    text-align: center;
    border: 1px solid #ddd;
    border-radius: 5px;
    margin: 0 10px;
}

.round-black-btn {
    display: inline-block;
    color: #fff;
    background-color: #FAABBD;
    padding: 10px 20px;
    border-radius: 5px;
    text-align: center;
    cursor: pointer;
    text-decoration: none;
}

.round-black-btn:hover {
    background-color: #333;
}

.reviews-counter {
    display: flex;
    align-items: center;
}

.rate input[type="radio"] {
    display: none;
}

.rate label {
    color: #FFD700;
    font-size: 20px;
    cursor: pointer;
}

.rate input:checked ~ label {
    color: #FFD700;
}

.product-info-tabs {
    padding-top: 80px;
}

.product-info-tabs .nav-tabs .nav-link.active {
    background-color: #FAABBD;
    border: 1px solid #FAABBD;
    color: #000;
}

.product-info-tabs .tab-content {
    padding: 20px;
    background-color: #f9f9f9;
    border: 1px solid #ddd;
}

.review-heading {
    font-size: 20px;
    font-weight: 500;
    margin-bottom: 20px;
    color: #FAABBD;
}

.review-form .form-group {
    margin-bottom: 20px;
}

.review-form .form-control {
    border-radius: 5px;
}
#size {
    width: 200px; /* Adjust the width as needed */
    font-size: 14px; /* Adjust the font size if necessary */
    padding: 10px; /* Add padding for better appearance */
}

.review-form .form-control {
    border-radius: 5px;
}

.rate {
    float: left;
    padding: 0 10px 0 0;
}
.rate:not(:checked) > input {
    position:absolute;
    top:-9999px;
}
.rate:not(:checked) > label {
    float: right;
    width: 15px;
    overflow: hidden;
    white-space: nowrap;
    cursor: pointer;
    font-size: 21px;
    color:#ccc;
  margin-bottom: 0;
  line-height: 21px;
}
.rate:not(:checked) > label:before {
    content: '\2605';
}
.rate > input:checked ~ label {
    color: #ffc700;    
}
.rate:not(:checked) > label:hover,
.rate:not(:checked) > label:hover ~ label {
    color: #deb217;  
}
.rate > input:checked + label:hover,
.rate > input:checked + label:hover ~ label,
.rate > input:checked ~ label:hover,
.rate > input:checked ~ label:hover ~ label,
.rate > label:hover ~ input:checked ~ label {
    color: #c59b08;
}
/* Responsive tweaks */
@media (max-width: 768px) {
    .product-count {
        flex-direction: column; /* Stack items vertically on smaller screens */
        align-items: flex-start; /* Align items to the left */
    }

    .product-count form {
        margin-bottom: 10px; /* Space between form and button */
    }
}

@media (max-width: 576px) {
    .product-count {
        flex-direction: column;
        align-items: flex-start; /* Ensure alignment to the left */
    }

    .product-count .qtyminus, .product-count .qtyplus {
        width: 40px; /* Adjust size for smaller screens */
    }

    .product-count .qty {
        width: 60px; /* Adjust size for smaller screens */
    }
}


</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const stars = document.querySelectorAll('.rating input[type="radio"]');
        const starLabels = document.querySelectorAll('.rating label');
    
        // Function to update the star rating display
        function updateStars(rating) {
            starLabels.forEach((label, index) => {
                if (index < rating) {
                    label.classList.add('filled');
                } else {
                    label.classList.remove('filled');
                }
            });
        }
    
        // Event listeners for mouseover and click events
        stars.forEach(star => {
            star.addEventListener('change', function() {
                const rating = parseInt(this.value);
                updateStars(rating);
            });
        });
    
        // Optional: Update stars on hover (for visual feedback)
        starLabels.forEach((label, index) => {
            label.addEventListener('mouseover', function() {
                updateStars(index + 1);
            });
            label.addEventListener('mouseout', function() {
                const checkedStar = document.querySelector('.rating input[type="radio"]:checked');
                const rating = checkedStar ? parseInt(checkedStar.value) : 0;
                updateStars(rating);
            });
        });
    });
    </script>
    
{% endblock %}
